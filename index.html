
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A' | Real-Time Quiz Duel</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}

body{
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:white;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
overflow:hidden;
}

.screen{
display:none;
width:100%;
max-width:500px;
text-align:center;
padding:20px;
}

.active{display:block}

button{
padding:12px 20px;
margin:10px;
border:none;
border-radius:8px;
cursor:pointer;
font-size:16px;
}

.primary{
background:#00c9ff;
color:black;
font-weight:bold;
}

.secondary{
background:#ff4b2b;
color:white;
}

.card{
background:rgba(255,255,255,0.08);
padding:20px;
border-radius:15px;
margin-top:20px;
}

.online{
color:#00ff88;
font-weight:bold;
}

.offline{
color:#ff4b2b;
font-weight:bold;
}

input{
padding:10px;
width:90%;
margin-top:10px;
border-radius:8px;
border:none;
}
</style>
</head>

<body>

<div class="screen active" id="splash">
<h1 style="font-size:60px">A'</h1>
<p>Real-Time Quiz Duel</p>
<button class="primary" onclick="showHome()">Start</button>
</div>

<div class="screen" id="home">
<h2>Create or Join Game</h2>
<button class="primary" onclick="createGame()">Create Game</button>

<div class="card">
<input id="roomInput" placeholder="Enter Invite Code"/>
<button class="secondary" onclick="joinGame()">Join Game</button>
</div>
</div>

<div class="screen" id="waiting">
<h2>Waiting for Opponent...</h2>
<p>Invite Link:</p>
<div class="card">
<p id="inviteLink"></p>
<button onclick="copyLink()">Copy Link</button>
</div>
</div>

<div class="screen" id="game">
<h2 id="roleTitle"></h2>
<p>Opponent: <span id="opponentStatus" class="offline">Offline</span></p>
<h3>Your Score: <span id="score">0</span></h3>

<div class="card">
<h3 id="questionText">Question appears here</h3>
<div id="answers"></div>
</div>
</div>

<script>
const SERVER_URL = "https://your-railway-backend.up.railway.app";
const socket = io(SERVER_URL);

let roomId = null;
let role = null;
let score = 0;

function showScreen(id){
document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

function showHome(){
showScreen("home");
}

function createGame(){
socket.emit("createRoom");
}

function joinGame(){
const input = document.getElementById("roomInput").value.trim();
if(input){
roomId = input;
socket.emit("joinRoom", roomId);
}
}

socket.on("roomCreated", data=>{
roomId = data.roomId;
role = "A";
const link = window.location.origin + window.location.pathname + "?room=" + roomId;
document.getElementById("inviteLink").innerText = link;
showScreen("waiting");
});

socket.on("roomJoined", data=>{
roomId = data.roomId;
role = "B";
});

socket.on("startGame", ()=>{
showScreen("game");
document.getElementById("roleTitle").innerText =
role === "A" ? "You are Player A" : "You are Player B";
});

socket.on("opponentStatus", status=>{
const el = document.getElementById("opponentStatus");
if(status){
el.innerText="Online";
el.className="online";
}else{
el.innerText="Offline";
el.className="offline";
}
});

socket.on("newQuestion", data=>{
document.getElementById("questionText").innerText = data.question;
const answersDiv = document.getElementById("answers");
answersDiv.innerHTML = "";
data.options.forEach(opt=>{
const btn = document.createElement("button");
btn.className="primary";
btn.innerText = opt;
btn.onclick = ()=>answer(opt);
answersDiv.appendChild(btn);
});
});

socket.on("scoreUpdate", newScore=>{
score = newScore;
document.getElementById("score").innerText = score;
});

function answer(choice){
socket.emit("answer",{roomId,choice});
}

function copyLink(){
navigator.clipboard.writeText(
document.getElementById("inviteLink").innerText
);
alert("Link Copied!");
}

window.onload = ()=>{
const params = new URLSearchParams(window.location.search);
if(params.get("room")){
roomId = params.get("room");
socket.emit("joinRoom", roomId);
}
};
</script>

</body>
</html>
